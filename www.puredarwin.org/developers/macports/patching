<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var b=window,e="chrome",f="tick",g="wtsrt_",h="tbsd_",k="tbnd_",l="start",n="_wtsrt",p="_tbnd";(function(){function m(a){this.t={};this.tick=function(a,c,d){this.t[a]=[void 0!=d?d:(new Date).getTime(),c]};this[f](l,null,a)}var a=new m;b.jstiming={Timer:m,load:a};if(b.performance&&b.performance.timing){var a=b.performance.timing,c=b.jstiming.load,d=a.navigationStart,a=a.responseStart;0<d&&a>=d&&(c[f](n,void 0,d),c[f](g,n,a),c[f](h,g))}try{a=null,b[e]&&b[e].csi&&(a=Math.floor(b[e].csi().pageT),c&&0<d&&(c[f](p,void 0,b[e].csi().startE),c[f](k,p,d))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),
null==a&&b.external&&(a=b.external.pageT,c&&0<d&&(c[f](p,void 0,b.external.startE),c[f](k,p,d))),a&&(b.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" type="image/x-icon" href="//www.google.com/images/icons/product/sites-16.ico" />
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/d24ef8/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d=window,e="length",h="",k="__duration__",l="function";function m(c){return document.getElementById(c)}d.byId=m;function n(c){return c.replace(/^\s+|\s+$/g,h)}d.trim=n;var p=[],q=0;d.JOT_addListener=function(c,a,b){var f=new String(q++);c={eventName:c,handler:a,compId:b,key:f};p.push(c);return f};d.JOT_removeListenerByKey=function(c){for(var a=0;a<p[e];a++)if(p[a].key==c){p.splice(a,1);break}};d.JOT_removeAllListenersForName=function(c){for(var a=0;a<p[e];a++)p[a].eventName==c&&p.splice(a,1)};
d.JOT_postEvent=function(c,a,b){var f={eventName:c,eventSrc:a||{},payload:b||{}};if(d.JOT_fullyLoaded)for(a=p[e],b=0;b<a&&b<p[e];b++){var g=p[b];g&&g.eventName==c&&(f.listenerCompId=g.compId||h,(g=typeof g.handler==l?g.handler:d[g.handler])&&g(f))}else d.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};d.JOT_delayedEvents=[];d.JOT_fullyLoaded=!1;
d.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var f=0;60<=b&&(b/=60,f=2);2<=b&&f++;return a?d.JOT_siteRelTimeStrs[f].replace(k,Math.floor(b)):d.JOT_userRelTimeStrs[f].replace(k,Math.floor(b))}; })()
</script>
<script>


var webspace = {"scottyUrl":"/_/upload","isConsumer":false,"canPublishScriptToAnyone":true,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"sharingUrlPrefix":"/_/sharing","csiReportUri":"http://csi.gstatic.com/csi","sharingPolicy":"OPENED_WITH_INDICATOR","analyticsAccountId":"UA-4515077-1","baseUri":"","name":"puredarwin","domain":"puredarwin.org","features":{"asyncPermanentDelete":false,"horizontalNavLayout":true,"folderEmbed":true,"scottyForTrogImageUpload":false,"moreBackgroundTweaks":true,"flipFolderUrls":true,"animateNavigation":true,"driveInFileCabinet":true,"skiThemeIsDefault":true,"pdfEmbedSupport":false,"animateToc":true,"siteChromeSidebarWidgetsEditDialog":true,"canonicalLinkTagInHead":false,"driveImageEmbed":true,"siteChromeSystemFooterDialog":true,"plusOneButtonOptions":true,"plusOneButton":true,"adSenseDeprecate":true,"photoAlbumsInOnePick":true,"docosHideNotificationSettings":true,"newInsertMenu":true,"skiTheme":true,"siteChromeDialogsToolbar":true,"plusBadge":false,"siteChromeHorizontalNavigationDialog":true,"youTubeEmbedSize":true,"adSenseDeprecateMsg":true,"htmlEmbed":true,"siteChromeHeaderDialog":true,"photoAlbumsGPlusUrlSupport":true,"disableGoogleVideo":true},"adsensePublisherId":"ca-pub-3519492571996731","gvizVersion":1,"siteTitle":"PureDarwin","pageSharingId":"jotspot_page","plusPageId":"","termsUrl":"http://sites.google.com/site/sites/system/app/pages/meta/terms?apps\u003d1","enableAnalytics":true,"isPublic":true,"plusPageUrl":"","homePath":"/","sharingId":"jotspot","isAdsenseEnabled":true,"adsensePromoClickedOrSiteIneligible":true,"isStartPageEnabled":true,"domainAnalyticsAccountId":""};



webspace.gadgets = {"baseUri":"/system/app/pages/gadgets"};


webspace.user = {"uid":"","renderMobile":false,"primaryEmail":"guest","sessionIndex":"","namespaceUser":false,"displayNameOrEmail":"guest","namespace":"","hasAdminAccess":false,"guest_":true,"keyboardShortcuts":true,"domain":"","hasWriteAccess":false,"dasherUser":false,"userName":"guest"};

webspace.page = {"canDeleteWebspace":null,"locale":"en","state":"","wuid":"wuid:gx:3c0b41b713badac1","pageInheritsPermissions":null,"timeZone":"America/Los_Angeles","properties":{},"type":"text","canChangePath":true,"parentWuid":"wuid:gx:3f4424d762b79d03","revision":34,"title":"Patching MacPorts to produce binaries for PureDarwin","isRtlLocale":false,"bidiEnabled":false,"siteLocale":"en","name":"patching","path":"/developers/macports/patching","isSiteRtlLocale":false,"parentPath":"/developers/macports"};
webspace.page.breadcrumbs = [{"title":"For developers","dir":"ltr","path":"/developers","deleted":false},{"title":"Using MacPorts","dir":"ltr","path":"/developers/macports","deleted":false},{"title":"Patching MacPorts to produce binaries for PureDarwin","dir":"ltr","path":"/developers/macports/patching","deleted":false}];


webspace.editorResources = {
  text: [
    'http://www.gstatic.com/sites/p/d24ef8/system/js/codemirror.js',
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/codemirror_css.css',
    'http://www.gstatic.com/sites/p/d24ef8/system/js/trog_edit__en.js',
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/trogedit.css',
    '/_/rsrc/1381649936000/system/app/css/editor.css',
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/codeeditor.css',
    '/_/rsrc/1381649936000/system/app/css/camelot/editor-jfk.css'
  ],
  sitelayout: [
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/sitelayouteditor.css'
  ]
};

var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/d24ef8/system/app/images/cleardot.gif';


var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];


webspace.siteTemplateId = false;


webspace.page.currentTemplate = {"title":"Web Page","path":"/system/app/pagetemplates/text"};



var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Patching MacPorts to produce binaries for PureDarwin - PureDarwin" />
<meta itemprop="name" content="Patching MacPorts to produce binaries for PureDarwin - PureDarwin" />
<meta property="og:title" content="Patching MacPorts to produce binaries for PureDarwin - PureDarwin" />
<meta itemprop="image" content="/_/rsrc/1204251241201/config/app/images/customLogo/pd.png?revision=1" />
<meta property="og:image" content="/_/rsrc/1204251241201/config/app/images/customLogo/pd.png?revision=1" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/d24ef8/system/app/themes/default/standard-css-default-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1381649936000/system/app/css/overlay.css?cb=defaultundefineda150goog-ws-left" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1381649936000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Patching MacPorts to produce binaries for PureDarwin - PureDarwin</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<script src="//www.gstatic.com/caja/5609/caja.js"> </script>
<script src="http://www.gstatic.com/sites/p/d24ef8/system/js/jot_caja.js"> </script>
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class=""><div class="sites-header-cell-buffer-wrapper"><a href="http://sites.google.com/a/puredarwin.org/puredarwin/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1204251241201/config/app/images/customLogo/pd.png?revision=1" alt="Logo" class="sites-logo " /></a><h2></h2></div></td><td class="sites-layout-searchbox "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container">
</td>
</tr>
</table> 
</div> 
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_5443624057807028" class="sites-embed"><h4 class="sites-embed-title">Navigation</h4><div class="sites-embed-content sites-sidebar-nav"><ul jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/news" jotId="wuid:gx:117960ccf6cea3d3" class="sites-navigation-link">News</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/screenshots" jotId="wuid:gx:381949cce98f8fe1" class="sites-navigation-link">Screenshots</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/downloads" jotId="wuid:gx:19ca24e3c9b23b1a" class="sites-navigation-link">Downloads</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/contact" jotId="wuid:gx:2682c13d3d043499" class="sites-navigation-link">Contact us</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/legal" jotId="wuid:gx:77c2ee3613fb2cc2" class="sites-navigation-link">Legal</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:2258cc2a13247b09" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_22101909201592207" class="sites-embed"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><img src="http://www.puredarwin.org/_/rsrc/1211558361866/config/app/images/hi-medium.jpg" style="border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px" /> The goal of this project is to make Darwin more usable by providing an installation ISO, documentation, and add-on software. You are welcome to join #puredarwin on irc.freenode.net if you would like to join PureDarwin development and to add to this site.</div></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_8098985916003585" class="sites-embed"><h4 class="sites-embed-title">Recent site activity</h4><div class="sites-embed-content sites-sidebar-recent-activity"><ul><li><a jotid="wuid:gx:48db54bc6a1c5a93" dir="ltr" href="http://www.puredarwin.org/news/newpuredarwin9l30betarelease">New PureDarwin 1.3 beta release</a><div><span class="sites-text-secondary">edited by PD admin</span></div><div><span class="sites-text-secondary">edited by Daniel Bethe</span></div></li><li><a jotid="wuid:gx:48db54bc6a1c5a93" dir="ltr" href="http://www.puredarwin.org/news/newpuredarwin9l30betarelease">New PureDarwin 9L30 beta release</a><div><span class="sites-text-secondary">edited by Daniel Bethe</span></div><div><span class="sites-text-secondary">created by PD admin</span></div></li><li><a jotid="wuid:gx:117960ccf6cea3d3" dir="ltr" href="http://www.puredarwin.org/news">News</a><div><span class="sites-text-secondary">edited by Ferdinand Klinzer</span></div></li><li><a jotid="wuid:gx:30ad1d3f494a9d46" dir="ltr" href="http://www.puredarwin.org/developers/vmware">VMware</a><div><span class="sites-text-secondary">edited by PD admin</span></div></li><li><a jotid="wuid:gx:52a0425ce78e58d8" dir="ltr" href="http://www.puredarwin.org/news/pcnet32-driver-for-puredarwin">PCnet32 driver for PureDarwin</a><div><span class="sites-text-secondary">edited by PD admin</span></div></li><li class="sites-sidebar-recent-activity-viewall"><a href="/system/app/pages/recentChanges">View All</a></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_08458635257557034" class="sites-embed"><div class="sites-embed-content-notitle"><span jotId="content"><p><script type="text/javascript">
<!--
google_ad_client="pub-3519492571996731";
google_ad_host="pub-6693688277674466";
google_ad_width=120;
google_ad_height=600;
google_ad_format="120x600_as";
google_ad_type="text_image";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="000000";
google_color_url="4E7DBF";
google_color_text="5E6A72";
//-->
</script>
<script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</p></span></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A dir="ltr" href="/developers">For developers</A>‎ &gt; ‎<A dir="ltr" href="/developers/macports">Using MacPorts</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr">Patching MacPorts to produce binaries for PureDarwin</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr">
<div style="margin-top:5px;margin-right:10px;margin-bottom:5px;margin-left:10px;display:inline;float:right"><a href="http://sites.google.com/a/puredarwin.org/puredarwin/developers/goog_1222698405894" imageanchor="1" style="color:rgb(0,102,204);outline-style:none;outline-width:initial;outline-color:initial"><img border="0" src="http://www.puredarwin.org/_/rsrc/1222694606788/developers/macports/macports-logo-top.png" style="border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px;border-style:initial;border-color:initial" /></a></div>
<a href="http://www.macports.org/" rel="nofollow" style="outline-style:none;outline-width:initial;outline-color:initial;color:rgb(85,26,139)" target="_blank">MacPorts</a>, formerly known as DarwinPorts, is a variant of the BSD ports system for Darwin and Mac OS X.
<div><br />
</div>
<div>Since the focus of the MacPorts project has shifted away from Darwin toward Mac OS X lately, it may be necessary create some patches in order to be able to use MacPorts-built software on PureDarwin.</div><div><br /></div><div>You can check <a href="https://trac.macports.org/query?status=assigned&amp;status=closed&amp;status=new&amp;status=reopened&amp;order=priority&amp;col=id&amp;col=summary&amp;col=status&amp;col=type&amp;col=priority&amp;col=milestone&amp;col=component&amp;keywords=%7Epuredarwin" rel="nofollow" target="_blank">here</a> which ports already have (or should have) puredarwin variants.<br />
<br />
This page describes how to create such patches.
<div><br />
</div>
<div>
<div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:430px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Making-a-puredarwin-variant"><strong>1 </strong>Making a +puredarwin variant</a></li><li class="goog-toc"><a href="#TOC-Case-study:-vim"><strong>2 </strong>Case study: vim</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Problem-statement"><strong>2.1 </strong>Problem statement</a></li><li class="goog-toc"><a href="#TOC-Finding-out-how-to-disable-the-proprietary-libraries-and-frameworks"><strong>2.2 </strong>Finding out how to disable the proprietary libraries and frameworks</a></li><li class="goog-toc"><a href="#TOC-Editing-the-portfile"><strong>2.3 </strong>Editing the portfile</a></li><li class="goog-toc"><a href="#TOC-Testing-the-modifications"><strong>2.4 </strong>Testing the modifications</a></li><li class="goog-toc"><a href="#TOC-Creating-and-submitting-a-patch-to-MacPorts"><strong>2.5 </strong>Creating and submitting a patch to MacPorts</a></li></ol></li><li class="goog-toc"><a href="#TOC-Case-study:-freetype"><strong>3 </strong>Case study: freetype</a></li><li class="goog-toc"><a href="#TOC-Case-study:-glib2"><strong>4 </strong>Case study: glib2</a></li><li class="goog-toc"><a href="#TOC-To-do"><strong>5 </strong>To do</a></li></ol></div></div></div></div>
</div>
<div><br />
</div>
<h3><a name="TOC-Making-a-puredarwin-variant"></a>Making a +puredarwin variant</h3>
<div>Some software in MacPorts compiles in a way that makes the binaries depend on proprietary, closed-source libraries and frameworks, such as Carbon.framework, CoreServices.framework, and others. Strangely, this sometimes is even the case for open source software that originally comes from other operating systems where these frameworks and libraries don't even exist, such as FreeBSD.</div>
<div><br />
</div>
<div>Since the proprietary, closed-source libraries and frameworks are not part of Darwin, it is necessary to patch the portfiles for such projects, as will be shown on this page.</div>
<h3><a name="TOC-Case-study:-vim"></a>Case study: vim</h3>
<h4><a name="TOC-Problem-statement"></a>Problem statement</h4>
<div><span style="font-weight:bold">Note that the following is example somewhat theoretical since a +puredarwin variant has been committed to the vim portfile after this article was written.</span></div>
<div><br />
</div>
<div>If as usual, you compile vim in MacPorts, the resulting binary will look like this:</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">otool -L /opt/local/bin/vim</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/bin/vim:</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.1)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/lib/libncurses.5.dylib (compatibility version 5.0.0, current version 5.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"> </span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(255,0,0)">/System/Library/Frameworks/Carbon.framework/Versions/A/Carbon (compatibility version 2.0.0, current version 136.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"> </span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(255,0,0)">/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices (compatibility version 1.0.0, current version 32.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(255,0,0)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(255,0,0)">/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 476.15.0)</span></span></span></div>
</div>
<div><br />
</div>
<div>The dependencies marked red are not part of Darwin and should not really be necessary for vim. So we need to change the portfile in a way that MacPorts can compile vim without these dependencies. It has been said, "<span style="font-style:italic">in a way</span>", implicitly meaning that there are many ways depending the case.</div>
<h4><a name="TOC-Finding-out-how-to-disable-the-proprietary-libraries-and-frameworks"></a>Finding out how to disable the proprietary libraries and frameworks</h4>
<div>Execute these commands:</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port info vim       # look at the description, variants and dependencies</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port cat vim        # look at the portfile raw content</span></span></div>
<div><span style="font-family:courier new;font-size:12px">port extract vim    # extract the original source</span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port patch vim      # appply MacPorts patches</span></span></div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">cd $(port work vim) # go to working directory</span></span></div>
<div><span style="font-family:courier new;font-size:12px"><span style="font-family:Arial;font-size:13px">
<div><br />
</div>
</span></span></div>
</div>
<div>Let's search the configure files there for mentions of Carbon (which is the first of the proprietary frameworks in the otool output above):</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">grep -r Carbon . | grep configure</span></span></div>
<div><span style="font-family:courier new;font-size:12px"><br />
</span></div>
<div>There we have it, lots of Carbon mentions.</div>
<div>In the same way, you can grep <span style="font-style:italic">config.log</span> if it exists.</div>
<div><br />
</div>
<div>In <span style="font-style:italic">vim72/src/auto/configure</span>, we see:</div>
<div><span style="font-family:courier new;font-size:12px"><br />
</span></div>
<div><span style="font-family:courier new;font-size:12px">enable_carbon_check</span></div>
<div><span style="font-family:courier new;font-size:12px"><br />
</span></div>
<div>In order to find what should be disable, we're looking configuration options manually (old dead-listing method, line by line).</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">./configure --help</span></span></div>
<div><br />
</div>
<div>This option seems interesting:</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">[...]</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">  --disable-darwin        Disable Darwin (Mac OS X) support.</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">[...]</span></span></div>
<div><br />
</div>
</div>
<div>Now, before editing the portfile, we first compile manually to see if the next result of otool will be clean, or not.</div>
<div>You can also add more options, reflecting variants you will use too.</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">./configure --prefix=/opt/local --disable-darwin ...</span></span></div>
<div><br />
</div>
<div>Then...</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">make</span></span></div>
<div><br />
</div>
<div>The result is clean:</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">./src/vim:</span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.1)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/lib/libncurses.5.dylib (compatibility version 5.0.0, current version 5.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)</span></span></span></div>
</div>
<div><br />
</div>
<h4><a name="TOC-Editing-the-portfile"></a>Editing the portfile</h4>
<div>Now we can edit the portfile and add +puredarwin platform (a variant alias) with relevant options.</div>
<div>First, copy the portfile:</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">cp $(port file vim) $(port file vim).orig</span></span></div>
<div> </div>
<div>Second, remember to backup your alternate portfile, cause a <span style="font-family:courier new,monospace"><span style="font-size:small">port selfupdate</span></span> will make you lose your modifications.</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port edit vim</span></span></div>
<div><br />
</div>
<div>Then just above the first variant declaration, add:</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">platform puredarwin {</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">    configure.args-append --disable-darwin</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">}</span></span></div>
<div><br />
</div>
</div>
<div>This case is really simple, it just needs a missing option. Sometimes you will have to use <span style="font-family:courier new,monospace"><span style="font-size:small">configure.args-delete</span></span> in order to also remove options.</div>
<div><br />
</div>
<div>The modifications are automatically reflected in description:</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port info vim</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">vim 7.2.021, editors/vim (Variants: universal, <span style="font-weight:bold">puredarwin</span>, athena, gtk1, gtk2, motif, tiny, small, big, huge, xim, perl, python, ruby, tcl, cscope, nls)</span></span></div>
<div><br />
</div>
<div>The modifications are also reflected in the final binary:</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port install vim <span style="font-weight:bold">-macosx </span><span><span style="font-weight:bold">+</span></span><span style="font-weight:bold">puredarwin</span> +tiny</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">Portfile changed since last build; discarding previous state.</span></span></span></div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">---&gt;  Fetching vim</span></span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">[...]</span></span></span></div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">---&gt;  Cleaning vim</span></span></span></div>
<div><br />
</div>
<div><span style="text-decoration:underline">Note:</span> You have probably noticed that <span style="font-family:courier new,monospace"><span style="font-size:small">-macosx</span></span> has been added, it's because of MacPorts nature which autodetects the host and adds corresponding platform/variant implicitly. Since we tend to avoid link to proprietary frameworks and other problematic dependencies.</div>
<h4><a name="TOC-Testing-the-modifications"></a>Testing the modifications</h4>
<div>Paranoid behavior makes we look again to the installed vim, it's a success.</div>
<div><br />
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">otool -L /opt/local/bin/vim</span></span></div>
</div>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/bin/vim:</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.1)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/lib/libncurses.5.dylib (compatibility version 5.0.0, current version 5.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/opt/local/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)</span></span></span></div>
<div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)"> </span></span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small"><span style="color:rgb(68,68,68)">/usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)</span></span></span></div>
<div><br />
</div>
<div>The goal has been reached.</div>
<h4><a name="TOC-Creating-and-submitting-a-patch-to-MacPorts"></a>Creating and submitting a patch to MacPorts</h4>
<div>Create a patch to be submitted to MacPorts:</div>
<div><br />
</div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">export P=vim ; diff -u $(port file $P).orig $(port file $P) &gt; Portfile-$P.diff</span></span></div>
<div><br />
</div>
<div>
<div>Check at</div>
<div><br />
</div>
<div>https://trac.macports.org/query?status=assigned&amp;status=closed&amp;status=new&amp;status=reopened&amp;order=priority&amp;col=id&amp;col=summary&amp;col=status&amp;col=type&amp;col=priority&amp;col=milestone&amp;col=component&amp;port=<span style="font-weight:bold">vim</span></div><div><br />whether a ticket for that port already exists that matches the topic of your patch. If not, create a new ticket at <a href="https://trac.macports.org/newticket" rel="nofollow" target="_blank">https://trac.macports.org/newticket</a> -  suggested values (copy and paste, but replace "packagename" and "version" with the real values):</div>
<div>
<ul>
<li><span style="font-weight:bold">Short Summary:</span> <span style="color:rgb(153,0,0)">packagename-version</span> puredarwin variant</li>
<li><span style="font-weight:bold">Full Description:</span> Patch to include a +puredarwin variant so that the resulting binary can run on [http://www.puredarwin.org/ PureDarwin], where proprietary frameworks and libraries are not available</li>
<li><span style="font-weight:bold">Type:</span> enhancement </li>
<li><span style="font-weight:bold">Milestone:</span> Port Enhancements</li>
<li><span style="font-weight:bold">Version: </span>(leave as is)</li>
<ul><li><span style="font-weight:bold">Cc:</span><span> <span style="color:rgb(153,0,0)">(the port maintainer)</span>,</span> probono(puredarwin.org), aladin(puredarwin.org) <span style="color:rgb(153,0,0)">(do not cc yourself)</span></li></ul>
<li><span style="font-weight:bold">Priority:</span> Normal</li>
<li><span style="font-weight:bold">Component:</span> ports</li>
<li><span style="font-weight:bold">Keywords:</span> <span style="color:rgb(153,0,0)">packagename</span>, puredarwin, haspatch</li>
<li><span style="font-weight:bold">Port:</span> <span style="color:rgb(153,0,0)">packagename</span></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h3><a name="TOC-Case-study:-freetype"></a>Case study: freetype</h3>
<div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">cp $(port file freetype) $(port file freetype).orig</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port edit freetype</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><br />
</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">platform puredarwin {</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">    configure.args-delete --with-old-mac-fonts</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">    configure.args-append --without-ats</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">}</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><br />
</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port info freetype</span></span></div>
<div><span style="font-family:courier new;font-size:12px"><br />
</span></div>
<div><span style="font-family:courier new;font-size:12px">port clean --all freetype</span></div>
<div><span style="font-family:courier new;font-size:12px">port -f destroot freetype +puredarwin</span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port rpm freetype +puredarwin</span></span></div>
<div><br />
</div>
<div><span style="font-family:courier new;font-size:12px">
<div>sh-3.2# port deactivate freetype</div>
<div>---&gt;  Deactivating freetype </div>
<div>sh-3.2# port activate freetype @2.3.7_1+puredarwin</div>
<div>---&gt;  Activating freetype 2.3.7_1+puredarwin</div>
<div>sh-3.2# port installed freetype</div>
<div>The following ports are currently installed:</div>
<div>  freetype @2.3.7_1</div>
<div>  freetype @2.3.7_1+puredarwin (active)</div>
</span></div>
<div><span style="font-family:courier new;font-size:12px"><br />
</span></div>
</div>
<span style="font-family:courier new;font-size:12px">diff -u $(port file freetype).orig $(port file freetype) &gt; Portfile-freetype.diff</span>
<h3 style="background-color:transparent;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:18px;margin-top:10px;margin-bottom:10px;margin-left:10px;margin-right:0px"><a name="TOC-Case-study:-glib2"></a>Case study: glib2</h3>
This case is a bit more complicated, since we need to patch configure.in if the +puredarwin variant is selected.</div><div><br /><div><span style="font-family:courier new,monospace"><span style="font-size:small">cd $(port work glib2)/glib-*/</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">cp configure.in configure.in.orig</span></span></div>
<div><span style="font-family:courier new;font-size:12px"><br />
</span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">nano configure.in</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"># delete Carbon-related portions</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><br />
</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">diff -u  configure.in.orig configure.in &gt; $(port dir glib2)/files/patch-configure.in.diff</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">cd -</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">cp $(port file glib2) $(port file glib2).orig</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><br />
</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">port edit glib2</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><br />
</span></span></div>
<div><span style="font-family:courier new;font-size:12px"># add</span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">platform puredarwin {</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">    patchfiles-append patch-configure.in.diff </span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">}</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small"><br />
</span></span></div>
<div><span style="font-family:courier new,monospace"><span style="font-size:small">diff -u $(port file glib2).orig $(port file glib2) &gt; Portfile-glib2.diff</span></span></div><div><span style="font-family:courier new;font-size:12px"><br /></span></div><div><div><span style="text-decoration:underline">Note:</span> Carbon has been explicitly added in 2007 to <span style="font-style:italic">configure.in</span> file as we can read in the <span style="font-style:italic">Changelog</span> file.</div><div><br /></div><div><span style="white-space:pre"><span style="font-family:courier new,monospace"><span style="font-size:small"> </span></span></span><span style="font-family:courier new,monospace"><span style="font-size:small">* configure.in: Add Carbon checks.</span></span></div><div><br /></div></div>Another way is to directly edit <span style="font-style:italic">configure</span> file.</div><div>At lines 4290 and 4291, comment or remove the problematic header includes:</div><div><br /></div><div><div><span style="font-family:courier new,monospace"><span style="font-size:small">#include &lt;Carbon/Carbon.h&gt;</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">#include &lt;CoreServices/CoreServices.h&gt;</span></span></div><div><br /></div><div>From line 4722 to 4729, you can comment all the block, or alternatively define HAVE_CARBON to 0 and remove -framework Carbon.</div><div><br /></div></div><div><div><span style="font-family:courier new,monospace"><span style="font-size:small">if test "x$glib_have_carbon" = "xyes"; then</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small"><br /></span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">#define HAVE_CARBON 1</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">_ACEOF</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small"><br /></span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">  LDFLAGS="$LDFLAGS -framework Carbon"</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">fi</span></span></div><div><br /></div></div><div><span style="text-decoration:underline">Note:</span> It hasn't been tested and doesn't appear to be needed for "purity" purpose (since it's worked with instructions just above), but other occurrences has been found:</div><div>Line 4311:</div><div><br /></div><div><div><span style="font-family:courier new,monospace"><span style="font-size:small">  glib_have_carbon=yes</span></span></div><div><span style="font-family:courier new;font-size:12px"><br /></span></div><div>From line 4356:</div><div><br /></div><div><div><span style="font-family:courier new,monospace"><span style="font-size:small"> if test "$glib_have_carbon" = "yes"; then</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">  OS_CARBON_TRUE=</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">  OS_CARBON_FALSE='#'</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">else</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">  OS_CARBON_TRUE='#'</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">  OS_CARBON_FALSE=</span></span></div><div><span style="font-family:courier new,monospace"><span style="font-size:small">fi</span></span></div></div><h3><a name="TOC-To-do"></a>To do</h3>
<div>Expand the otool check so that it can be included in MacPorts as a "purity tester" (i.e., check that anything that comes out of MacPorts is free from links to proprietary, closed-source libraries and frameworks).</div>
<div><br />
</div>
<div><span style="font-size:18px;font-weight:bold">References</span></div>
<div>
<div><a href="http://guide.macports.org/" rel="nofollow" target="_blank">MacPorts Guide</a></div>
</div>
</div>
</div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-attachments">
<div class="sites-attachments-row"><div class="sites-attachments-icon" style="left:0px;"><div class="sites-translucent sites-symbol">Č</div></div></div><div class="sites-attachments-separator"></div>
<div id="attachment-wuid:gx:6e1079f317aa53f9"><div class="sites-attachments-row"><div class="sites-attachments-icon" style="left:5px"><div class="sites-translucent sites-symbol">ċ</div></div><a href="/developers/macports/patching/patchhelper.sh?attredirects=0&amp;d=1" title="Download"><div id="attachment-download-wuid:gx:6e1079f317aa53f9" class="sites-attachments-icon" style="right:0px"><span class="sites-symbol">ď</span></div></a><div class="sites-attachments-version"><a href="/system/app/pages/admin/revisions?wuid=wuid:gx:6e1079f317aa53f9">v.1</a></div><div class="sites-attachments-inner-div"><div class="sites-attachments-name">patchhelper.sh <div class="sites-translucent">(1k)</div></div><div class="sites-attachments-author">PD admin, <div class="sites-translucent">Oct 12, 2008, 7:58 AM</div></div></div></div><div class="sites-attachments-separator"></div></div>
<div style="height: 10px"></div>
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/a/puredarwin.org/puredarwin/developers/macports/patching">Sign in</a>|<a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a>|<a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a>|<a class="sites-system-link" href="/system/app/pages/removeAccess" target="_blank">Remove Access</a>|<span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>

<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/d24ef8/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
    
        sites.core.Analytics.createTracker();
        sites.core.Analytics.trackPageview();
      
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("5443624057807028", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_5443624057807028');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
          JOT_addListener('titleChange', 'JOT_RECENTCHANGES_titleChange', 'COMP_8098985916003585');
        </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXuiEJWuCB_LZagUAJWJE5fSAeie3STAS7tAHgFfprp4cz0Mt1Vehg7nhaijsP11UiWxAsmV7_bwBAjekAwo_KvMGuTg6sukKM_lJT3cTWqh_PhJ_V3hEkp7ajfz6DoHVcVHjEfq/api/js?anon=true', true, true,
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('http://www.puredarwin.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type;
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
 //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
              JOT_postEvent('renderPlus', null, 'sites-chrome-main');
            </script>
<div id="server-timer-div" style="display:none"> </div>
<script>
          window.jstiming.load.tick('render');
        </script>
</body>
</html>
