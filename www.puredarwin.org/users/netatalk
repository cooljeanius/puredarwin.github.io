<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var b=window,e="chrome",f="tick",g="wtsrt_",h="tbsd_",k="tbnd_",l="start",n="_wtsrt",p="_tbnd";(function(){function m(a){this.t={};this.tick=function(a,c,d){this.t[a]=[void 0!=d?d:(new Date).getTime(),c]};this[f](l,null,a)}var a=new m;b.jstiming={Timer:m,load:a};if(b.performance&&b.performance.timing){var a=b.performance.timing,c=b.jstiming.load,d=a.navigationStart,a=a.responseStart;0<d&&a>=d&&(c[f](n,void 0,d),c[f](g,n,a),c[f](h,g))}try{a=null,b[e]&&b[e].csi&&(a=Math.floor(b[e].csi().pageT),c&&0<d&&(c[f](p,void 0,b[e].csi().startE),c[f](k,p,d))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),
null==a&&b.external&&(a=b.external.pageT,c&&0<d&&(c[f](p,void 0,b.external.startE),c[f](k,p,d))),a&&(b.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" type="image/x-icon" href="//www.google.com/images/icons/product/sites-16.ico" />
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/d24ef8/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d=window,e="length",h="",k="__duration__",l="function";function m(c){return document.getElementById(c)}d.byId=m;function n(c){return c.replace(/^\s+|\s+$/g,h)}d.trim=n;var p=[],q=0;d.JOT_addListener=function(c,a,b){var f=new String(q++);c={eventName:c,handler:a,compId:b,key:f};p.push(c);return f};d.JOT_removeListenerByKey=function(c){for(var a=0;a<p[e];a++)if(p[a].key==c){p.splice(a,1);break}};d.JOT_removeAllListenersForName=function(c){for(var a=0;a<p[e];a++)p[a].eventName==c&&p.splice(a,1)};
d.JOT_postEvent=function(c,a,b){var f={eventName:c,eventSrc:a||{},payload:b||{}};if(d.JOT_fullyLoaded)for(a=p[e],b=0;b<a&&b<p[e];b++){var g=p[b];g&&g.eventName==c&&(f.listenerCompId=g.compId||h,(g=typeof g.handler==l?g.handler:d[g.handler])&&g(f))}else d.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};d.JOT_delayedEvents=[];d.JOT_fullyLoaded=!1;
d.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var f=0;60<=b&&(b/=60,f=2);2<=b&&f++;return a?d.JOT_siteRelTimeStrs[f].replace(k,Math.floor(b)):d.JOT_userRelTimeStrs[f].replace(k,Math.floor(b))}; })()
</script>
<script>


var webspace = {"scottyUrl":"/_/upload","isConsumer":false,"canPublishScriptToAnyone":true,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"sharingUrlPrefix":"/_/sharing","csiReportUri":"http://csi.gstatic.com/csi","sharingPolicy":"OPENED_WITH_INDICATOR","analyticsAccountId":"UA-4515077-1","baseUri":"","name":"puredarwin","domain":"puredarwin.org","features":{"asyncPermanentDelete":false,"horizontalNavLayout":true,"folderEmbed":true,"scottyForTrogImageUpload":false,"moreBackgroundTweaks":true,"flipFolderUrls":true,"animateNavigation":true,"driveInFileCabinet":true,"skiThemeIsDefault":true,"pdfEmbedSupport":false,"animateToc":true,"siteChromeSidebarWidgetsEditDialog":true,"canonicalLinkTagInHead":false,"driveImageEmbed":true,"siteChromeSystemFooterDialog":true,"plusOneButtonOptions":true,"plusOneButton":true,"adSenseDeprecate":true,"photoAlbumsInOnePick":true,"docosHideNotificationSettings":true,"newInsertMenu":true,"skiTheme":true,"siteChromeDialogsToolbar":true,"plusBadge":false,"siteChromeHorizontalNavigationDialog":true,"youTubeEmbedSize":true,"adSenseDeprecateMsg":true,"htmlEmbed":true,"siteChromeHeaderDialog":true,"photoAlbumsGPlusUrlSupport":true,"disableGoogleVideo":true},"adsensePublisherId":"ca-pub-3519492571996731","gvizVersion":1,"siteTitle":"PureDarwin","pageSharingId":"jotspot_page","plusPageId":"","termsUrl":"http://sites.google.com/site/sites/system/app/pages/meta/terms?apps\u003d1","enableAnalytics":true,"isPublic":true,"plusPageUrl":"","homePath":"/","sharingId":"jotspot","isAdsenseEnabled":true,"adsensePromoClickedOrSiteIneligible":true,"isStartPageEnabled":true,"domainAnalyticsAccountId":""};



webspace.gadgets = {"baseUri":"/system/app/pages/gadgets"};


webspace.user = {"uid":"","renderMobile":false,"primaryEmail":"guest","sessionIndex":"","namespaceUser":false,"displayNameOrEmail":"guest","namespace":"","hasAdminAccess":false,"guest_":true,"keyboardShortcuts":true,"domain":"","hasWriteAccess":false,"dasherUser":false,"userName":"guest"};

webspace.page = {"canDeleteWebspace":null,"locale":"en","state":"","wuid":"wuid:gx:7f8b4dee59e198c7","pageInheritsPermissions":null,"timeZone":"America/Los_Angeles","properties":{},"type":"text","canChangePath":true,"parentWuid":"wuid:gx:4f6867f52a017d59","revision":28,"title":"Netatalk","isRtlLocale":false,"bidiEnabled":false,"siteLocale":"en","name":"netatalk","path":"/users/netatalk","isSiteRtlLocale":false,"parentPath":"/users"};
webspace.page.breadcrumbs = [{"title":"For users","dir":"ltr","path":"/users","deleted":false},{"title":"Netatalk","dir":"ltr","path":"/users/netatalk","deleted":false}];


webspace.editorResources = {
  text: [
    'http://www.gstatic.com/sites/p/d24ef8/system/js/codemirror.js',
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/codemirror_css.css',
    'http://www.gstatic.com/sites/p/d24ef8/system/js/trog_edit__en.js',
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/trogedit.css',
    '/_/rsrc/1381649936000/system/app/css/editor.css',
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/codeeditor.css',
    '/_/rsrc/1381649936000/system/app/css/camelot/editor-jfk.css'
  ],
  sitelayout: [
    'http://www.gstatic.com/sites/p/d24ef8/system/app/css/sitelayouteditor.css'
  ]
};

var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/d24ef8/system/app/images/cleardot.gif';


var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];


webspace.siteTemplateId = false;


webspace.page.currentTemplate = {"title":"Web Page","path":"/system/app/pagetemplates/text"};



var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Netatalk - PureDarwin" />
<meta itemprop="name" content="Netatalk - PureDarwin" />
<meta property="og:title" content="Netatalk - PureDarwin" />
<meta itemprop="image" content="/_/rsrc/1204251241201/config/app/images/customLogo/pd.png?revision=1" />
<meta property="og:image" content="/_/rsrc/1204251241201/config/app/images/customLogo/pd.png?revision=1" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/d24ef8/system/app/themes/default/standard-css-default-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1381649936000/system/app/css/overlay.css?cb=defaultundefineda150goog-ws-left" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1381649936000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Netatalk - PureDarwin</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<script src="//www.gstatic.com/caja/5609/caja.js"> </script>
<script src="http://www.gstatic.com/sites/p/d24ef8/system/js/jot_caja.js"> </script>
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class=""><div class="sites-header-cell-buffer-wrapper"><a href="http://sites.google.com/a/puredarwin.org/puredarwin/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1204251241201/config/app/images/customLogo/pd.png?revision=1" alt="Logo" class="sites-logo " /></a><h2></h2></div></td><td class="sites-layout-searchbox "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container">
</td>
</tr>
</table> 
</div> 
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_5443624057807028" class="sites-embed"><h4 class="sites-embed-title">Navigation</h4><div class="sites-embed-content sites-sidebar-nav"><ul jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/news" jotId="wuid:gx:117960ccf6cea3d3" class="sites-navigation-link">News</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/screenshots" jotId="wuid:gx:381949cce98f8fe1" class="sites-navigation-link">Screenshots</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/downloads" jotId="wuid:gx:19ca24e3c9b23b1a" class="sites-navigation-link">Downloads</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/contact" jotId="wuid:gx:2682c13d3d043499" class="sites-navigation-link">Contact us</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/legal" jotId="wuid:gx:77c2ee3613fb2cc2" class="sites-navigation-link">Legal</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:2258cc2a13247b09" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_22101909201592207" class="sites-embed"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><img src="http://www.puredarwin.org/_/rsrc/1211558361866/config/app/images/hi-medium.jpg" style="border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px" /> The goal of this project is to make Darwin more usable by providing an installation ISO, documentation, and add-on software. You are welcome to join #puredarwin on irc.freenode.net if you would like to join PureDarwin development and to add to this site.</div></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_8098985916003585" class="sites-embed"><h4 class="sites-embed-title">Recent site activity</h4><div class="sites-embed-content sites-sidebar-recent-activity"><ul><li><a jotid="wuid:gx:48db54bc6a1c5a93" dir="ltr" href="http://www.puredarwin.org/news/newpuredarwin9l30betarelease">New PureDarwin 1.3 beta release</a><div><span class="sites-text-secondary">edited by PD admin</span></div><div><span class="sites-text-secondary">edited by Daniel Bethe</span></div></li><li><a jotid="wuid:gx:48db54bc6a1c5a93" dir="ltr" href="http://www.puredarwin.org/news/newpuredarwin9l30betarelease">New PureDarwin 9L30 beta release</a><div><span class="sites-text-secondary">edited by Daniel Bethe</span></div><div><span class="sites-text-secondary">created by PD admin</span></div></li><li><a jotid="wuid:gx:117960ccf6cea3d3" dir="ltr" href="http://www.puredarwin.org/news">News</a><div><span class="sites-text-secondary">edited by Ferdinand Klinzer</span></div></li><li><a jotid="wuid:gx:30ad1d3f494a9d46" dir="ltr" href="http://www.puredarwin.org/developers/vmware">VMware</a><div><span class="sites-text-secondary">edited by PD admin</span></div></li><li><a jotid="wuid:gx:52a0425ce78e58d8" dir="ltr" href="http://www.puredarwin.org/news/pcnet32-driver-for-puredarwin">PCnet32 driver for PureDarwin</a><div><span class="sites-text-secondary">edited by PD admin</span></div></li><li class="sites-sidebar-recent-activity-viewall"><a href="/system/app/pages/recentChanges">View All</a></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_08458635257557034" class="sites-embed"><div class="sites-embed-content-notitle"><span jotId="content"><p><script type="text/javascript">
<!--
google_ad_client="pub-3519492571996731";
google_ad_host="pub-6693688277674466";
google_ad_width=120;
google_ad_height=600;
google_ad_format="120x600_as";
google_ad_type="text_image";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="000000";
google_color_url="4E7DBF";
google_color_text="5E6A72";
//-->
</script>
<script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</p></span></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A dir="ltr" href="/users">For users</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr">Netatalk</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div style="display:inline;float:right;margin-top:5px;margin-right:10px;margin-bottom:5px;margin-left:10px"><a href="http://www.puredarwin.org/users/netatalk/netatalk.png?attredirects=0" imageanchor="1"><img border="0" src="http://www.puredarwin.org/_/rsrc/1263721308153/users/netatalk/netatalk.png" /></a></div>Mac OS X comes with a Apple File Protocol (AFP) server which is closed source and unavailable for PureDarwin. Hence, if you would like to use PureDarwin as a file, print and time server for Macintosh computers, you need to use netatalk, a third-party, open source implementation of the AppleTalk suite of protocols. It allows PureDarwin to act as an AFP server and can act as a Time Machine server similar to Apple's Time Capsule. This page describes how to install and configure netatalk on PureDarwin.</div><div><br /></div><div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Installing-netatalk-on-PureDarwin"><strong>1 </strong>Installing netatalk on PureDarwin</a></li><li class="goog-toc"><a href="#TOC-Configuring-netatalk"><strong>2 </strong>Configuring netatalk</a></li><li class="goog-toc"><a href="#TOC-Announcing-to-Bonjour-mDNSResponder-"><strong>3 </strong>Announcing to Bonjour (mDNSResponder)</a></li></ol></div></div></div></div></div><h2><a name="TOC-Installing-netatalk-on-PureDarwin"></a>Installing netatalk on PureDarwin</h2><div>netatalk can be installed from MacPorts. Execute the following command to start it, and to cause it to launch at startup:</div><div><font face="'courier new', monospace"><span style="font-size:small">sudo launchctl load -w /Library/LaunchDaemons/org.macports.netatalk.plist</span></font></div><div>This, among other things, launches <font face="'courier new', monospace"><span style="font-size:small">/opt/local/sbin/afpd</span></font>, which is netatalk's AFP server.</div><div>From this moment on, you should be able to connect to your server from any mac using afp://servername or afp://0.0.0.0 (using your server's IP adress). </div><div><h2><a name="TOC-Configuring-netatalk"></a>Configuring netatalk</h2><div>After installation, you will be unable to log in. Instead, you will get a message that the username/password is wrong, and /opt/local/var/log/netatalk.log shows </div></div><div><font><font face="'courier new', monospace"><span style="font-size:small">[uams_dhx_pam.c:497]: I:UAMSDaemon: uams_dhx_pam.c :PAM: PAM_Error: Authentication failure</span></font></font></div><div><br /></div><div>This can be fixed by creating the file <font face="'courier new', monospace"><span style="font-size:small">/etc/pam.d/netatalk</span></font> with the following content:</div><div><div><font face="'courier new', monospace"><span style="font-size:small">auth       required       pam_nologin.so</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">auth       sufficient     pam_securityserver.so</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">auth       sufficient     pam_unix.so</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">auth       required       pam_deny.so</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">account    required       pam_permit.so</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">password   required       pam_deny.so</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">session    required       pam_uwtmp.so</span></font></div><div><br /></div></div><div>Now you should be able to log in using your username and password, and should be able to access your files. See MacPorts <a href="https://trac.macports.org/ticket/23313" rel="nofollow" target="_blank">#23313</a></div><div><br /></div><div>By default, every user can access his home directory. Note however that every user can mark other areas he has (read) access to as shared, including the entire hard disk. All he has to do is create a file <font face="'courier new', monospace"><span style="font-size:small">.AppleVolumes</span></font> in his home directory with the following content:</div><div><div><font face="'courier new', monospace"><span style="font-size:small"># Export the entire hard disk</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">/</span></font><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">"/"</span></font></div></div><div>Is it possible to disallow users from this?</div><h2><a name="TOC-Announcing-to-Bonjour-mDNSResponder-"></a>Announcing to Bonjour (mDNSResponder)</h2><div>This section is about announcing the server on the local network, so that it shows up in the Finder:</div><div><br /></div><div><a href="http://www.puredarwin.org/users/netatalk/Bildschirmfoto%202010-01-17%20um%2002.58.49.png?attredirects=0" imageanchor="1" style="color:rgb(85,26,139);outline-style:none;outline-width:initial;outline-color:initial;background-repeat:initial;background-color:initial;border-bottom-style:none;border-bottom-width:initial;border-bottom-color:initial"><img border="0" src="http://www.puredarwin.org/_/rsrc/1263693560135/users/netatalk/Bildschirmfoto%202010-01-17%20um%2002.58.49.png" style="border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px;border-style:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px" /></a></div><div><br /></div><div><a href="http://www.puredarwin.org/users/netatalk/Bildschirmfoto%202010-01-17%20um%2002.58.49.png?attredirects=0" imageanchor="1" style="color:rgb(85,26,139);outline-style:none;outline-width:initial;outline-color:initial;background-repeat:initial;background-color:initial;border-bottom-style:none;border-bottom-width:initial;border-bottom-color:initial"></a>On the Mac, the AppleFileServer is launched and announced on the local network via <a href="http://www.puredarwin.org/users/bonjour">Bonjour</a> using the following LaunchDaemons plist file. We would like to do the same with netatalk, but we are running into problems...</div><div><br /></div><div><div><font face="'courier new', monospace"><span style="font-size:small">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">&lt;plist version="1.0"&gt;</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">&lt;dict&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;Disabled&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;true/&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;EnableTransactions&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;true/&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;GroupName&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;string&gt;wheel&lt;/string&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;Label&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;string&gt;com.apple.AppleFileServer&lt;/string&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;MachServices&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;dict&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;com.apple.AppleFileServer&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;dict&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;HideUntilCheckIn&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;true/&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;/dict&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;/dict&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;ProgramArguments&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;array&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;string&gt;/usr/sbin/AppleFileServer&lt;/string&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;/array&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;key&gt;Sockets&lt;/key&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;dict&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;key&gt;Listener&lt;/key&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;dict&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;key&gt;Bonjour&lt;/key&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;true/&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;key&gt;SockServiceName&lt;/key&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;string&gt;afpovertcp&lt;/string&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;/dict&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"><b> </b></span></font></span><font face="'courier new', monospace"><span style="font-size:small"><b>&lt;/dict&gt;</b></span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;key&gt;WaitForDebugger&lt;/key&gt;</span></font></div><div><span style="white-space:pre"><font face="'courier new', monospace"><span style="font-size:small"> </span></font></span><font face="'courier new', monospace"><span style="font-size:small">&lt;false/&gt;</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">&lt;/dict&gt;</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">&lt;/plist&gt;</span></font></div><div><br /></div><div>This tells launchd to announce the AFP server on the local network with Bonjour and launch the AFP server whenever the "afpovertcp" port is accessed. The file <font face="'courier new', monospace"><span style="font-size:small">/etc/services</span></font> contains the definition that this equals port 548. </div><div><br /></div><div>If we copy the bold part from above into the netatalk LaunchDaemon plist, then netatalk gets announced on the local network as a server (i.e., it shows up automatically on the left-hand side in Finder), but we get</div><div><font face="'courier new', monospace"><span style="font-size:small">E:AFPDaemon: main: dsi_init: Address already in use</span></font></div><div>in the syslog and cannot connect to the server because afpd can't start.</div><div><br /></div><div><font color="#FF0000">Please let us know what to do. <span style="color:rgb(0,0,0)">See MacPorts <a href="https://trac.macports.org/ticket/23315" rel="nofollow" target="_blank">#23315</a>. According to the maintainer, this has been discussed upstream. As of January 2010, there is a proposal for a possible solution, which might be included in some future Netatalk release.</span></font></div><div><br /></div><div>As a workaround, you can edit /opt/local/etc/netatalk/initscript so that it starts and stops dns-sd. While this is not elegant, it does work at least. Insert the three bold lines into /opt/local/etc/netatalk/initscript:</div><div><br /></div><div><div><font face="'courier new', monospace"><span style="font-size:small">"$PREFIX/sbin/afpd" $AFPD_UAMLIST -g $AFPD_GUEST -c $AFPD_MAX_CLIENTS </span></font></div><div><font face="'courier new', monospace"><span style="font-size:small"><b>dns-sd -R . _afpovertcp._tcp . 548 &amp;</b></span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">printf " Done.\n"</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">(…)</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">    kill $CNID_PID</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small"><b>DNS_SD_PID=`ps aux | grep -v awk | awk '/^root.*afpovertcp/ {print $2}'`</b></span></font></div><div><font face="'courier new', monospace"><span style="font-size:small"><b>    kill DNS_SD_PID</b></span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">fi</span></font></div><div><br /></div></div><div>Reload with</div><div><font face="'courier new', monospace"><span style="font-size:small">sudo launchctl unload -w /Library/LaunchDaemons/org.macports.netatalk.plist</span></font></div><div><font face="'courier new', monospace"><span style="font-size:small">sudo launchctl load -w /Library/LaunchDaemons/org.macports.netatalk.plist</span></font></div><div><br /></div><div>Now you should see your PureDarwin server in the Finder of the Macs in your local network and should be able to connect and log in using the server username and password.</div><div><br /></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/a/puredarwin.org/puredarwin/users/netatalk">Sign in</a>|<a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a>|<a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a>|<a class="sites-system-link" href="/system/app/pages/removeAccess" target="_blank">Remove Access</a>|<span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>

<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/d24ef8/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
    
        sites.core.Analytics.createTracker();
        sites.core.Analytics.trackPageview();
      
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("5443624057807028", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_5443624057807028');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
          JOT_addListener('titleChange', 'JOT_RECENTCHANGES_titleChange', 'COMP_8098985916003585');
        </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXuiEJWuCB_LZagUAJWJE5fSAeie3STAS7tAHgFfprp4c-hb5lV8E0fAn8GpS6NzfYrEVVnwx3pOagllcFDgst00hmG0rOSnAKKnhGuRLRdBgiyycOGgBTtdCZL7BUs2sXMD0zbH/api/js?anon=true', true, true,
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('http://www.puredarwin.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type;
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
 //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
              JOT_postEvent('renderPlus', null, 'sites-chrome-main');
            </script>
<div id="server-timer-div" style="display:none"> </div>
<script>
          window.jstiming.load.tick('render');
        </script>
</body>
</html>
